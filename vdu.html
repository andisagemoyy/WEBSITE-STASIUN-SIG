<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simpang | Real-time KA Monitoring</title>
  <link rel="shortcut icon" href="assets/logo (2).png" type="image/x-icon">
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: black;
      color: white;
    }
    .tabs {
      display: flex;
      justify-content: center;
      background-color: #111;
      border-bottom: 1px solid #333;
    }
    .tab-button {
      padding: 12px 20px;
      cursor: pointer;
      background: #111;
      border: none;
      color: white;
      font-weight: bold;
      transition: background 0.3s;
    }
    .tab-button:hover, .tab-button.active {
      background-color: #333;
    }
    .tab-content {
      display: none;
      padding: 20px;
    }
    .tab-content.active {
      display: block;
    }
    /* Common styles for all tabs */
    .yard {
      position: relative;
      width: 1000px;
      height: 600px;
      margin: auto;
    }
    .track {
      stroke: white;
      stroke-width: 2;
      fill: none;
      transition: stroke 0.3s;
    }
    .input-pair {
      display: flex;
      position: absolute;
      align-items: center;
    }
    .arrow {
      color: white;
      font-size: 14px;
      margin: 0 4px;
    }
    .input-box {
      width: 80px;
      height: 20px;
      background: transparent;
      border: 2px solid white;
      color: white;
      text-align: center;
      font-size: 12px;
    }
    .input-box::placeholder {
      color: rgba(255,255,255,0.4);
    }
    .controls {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: rgba(0,0,0,0.7);
      padding: 10px;
      border-radius: 5px;
      border: 1px solid rgba(255,255,255,0.2);
    }
    button {
      background-color: rgba(80,80,80,0.5);
      color: white;
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 4px;
      padding: 5px 10px;
      margin: 3px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: rgba(100,100,100,0.8);
    }
    .status {
      color: rgba(255,255,255,0.7);
      font-size: 12px;
      margin-top: 10px;
      text-align: center;
    }
    .label {
      position: absolute;
      left: 5px;
      font-size: 12px;
      background-color: rgba(255,255,255,0.1);
      padding: 2px 6px;
      border-radius: 4px;
    }
    .track.permanent {
      stroke: white !important;
    }
    .track.occupied {
      stroke: red;
    }
    /* WBS specific styles */
    #wbs svg {
      position: absolute;
      top: 0;
      left: 0;
    }
    #wbs .label {
      left: 10px;
    }
    #wbs .input-box {
      width: 70px;
      margin: 0 2px;
    }
    /* Indikator live */
    .live-indicator {
      position: fixed;
      top: 5px;
      right: 5px;
      background-color: rgba(0,0,0,0.7);
      padding: 5px 10px;
      border-radius: 5px;
      z-index: 1000;
      display: flex;
      align-items: center;
    }
    .live-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: red;
      margin-right: 5px;
      animation: blink 1s infinite;
    }
    @keyframes blink {
      0% { opacity: 0.3; }
      50% { opacity: 1; }
      100% { opacity: 0.3; }
    }
    
    /* Login Styles */
    .login-container {
      position: fixed;
      top: 5px;
      left: 5px;
      z-index: 1000;
      display: flex;
      align-items: center;
    }
    
    .login-btn {
      background-color: rgba(0,0,0,0.7);
      color: white;
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 4px;
      padding: 5px 15px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
    }
    
    .login-btn:hover {
      background-color: rgba(50,50,50,0.8);
    }
    
    .login-icon {
      margin-right: 5px;
      font-size: 16px;
    }
    
    .user-status {
      background-color: rgba(0,0,0,0.7);
      color: rgba(255,255,255,0.8);
      border-radius: 4px;
      padding: 5px 15px;
      margin-left: 10px;
      font-size: 12px;
    }
    
    .editor-status {
      color: #4CAF50;
      font-weight: bold;
    }
    
    .viewer-status {
      color: #FFC107;
    }
    
    /* Login Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.7);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }
    
    .modal-content {
      background-color: #1a1a1a;
      padding: 20px;
      border-radius: 5px;
      width: 300px;
      border: 1px solid #333;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      border-bottom: 1px solid #333;
      padding-bottom: 10px;
    }
    
    .close-btn {
      background: none;
      border: none;
      color: #999;
      font-size: 20px;
      cursor: pointer;
    }
    
    .close-btn:hover {
      color: white;
    }
    
    .login-form input {
      width: 100%;
      padding: 8px;
      margin: 8px 0;
      background-color: #333;
      border: 1px solid #444;
      border-radius: 4px;
      color: white;
    }
    
    .login-form input:focus {
      outline: none;
      border-color: #666;
    }
    
    .login-form button {
      width: 100%;
      padding: 10px;
      margin-top: 15px;
      background-color: #444;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .login-form button:hover {
      background-color: #555;
    }
    
    .login-error {
      color: #f44336;
      margin-top: 10px;
      font-size: 14px;
      text-align: center;
      display: none;
    }
    
    /* For read-only mode */
    .read-only {
      pointer-events: none;
      opacity: 0.7;
    }
  </style>
</head>
<body>
  <!-- Login Container -->
  <div class="login-container">
    <button class="login-btn" id="loginToggleBtn">
      <span class="login-icon">ðŸ‘¤</span> Log In
    </button>
    <div class="user-status">
      <span class="viewer-status">Mode: Viewer</span>
    </div>
  </div>

  <!-- Login Modal -->
  <div class="modal" id="loginModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Login dulu ya</h3>
        <button class="close-btn">&times;</button>
      </div>
      <div class="login-form">
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">
        <button id="loginBtn">Login</button>
        <p class="login-error" id="loginError">Username atau password salah!</p>
      </div>
    </div>
  </div>

  <!-- Indikator LIVE -->
  <div class="live-indicator">
    <div class="live-dot"></div>
    <span>LIVE</span>
  </div>

  <div class="tabs">
    <button class="tab-button active" onclick="switchTab('rmk')">CY RMK</button>
    <button class="tab-button" onclick="switchTab('wbs')">CY WBS</button>
    <button class="tab-button" onclick="switchTab('fms')">CY FMS</button>
  </div>

  <div id="rmk" class="tab-content active">
    <div class="yard">
      <svg width="1000" height="600" style="position: absolute; top: 0; left: 0;">
        <!-- Jalur tetap -->
        <polyline id="main-track" points="1000,300 850,300 800,250" stroke="white" stroke-width="3" fill="none" class="track" />
        <polyline id="w1-w3" points="800,250 750,250" stroke="white" stroke-width="3" fill="none" class="track" />
        <polyline id="w1-w2" points="800,250 750,350" stroke="white" stroke-width="3" fill="none" class="track" />
  
        <!-- CY 2 Jalur 1 -->
        <polyline id="track-cy2-1-serong" points="750,250 700,200" stroke="white" stroke-width="3" fill="none" class="track" />
        <polyline id="track-cy2-1-lurus" points="700,200 250,200" stroke="white" stroke-width="3" fill="none" class="track" />
  
        <!-- CY 2 Jalur 2 -->
        <polyline id="track-cy2-2" points="750,250 250,250" stroke="white" stroke-width="3" fill="none" class="track" />
  
        <!-- CY 2 Jalur 3 -->
        <polyline id="track-cy2-3-serong" points="750,250 700,300" stroke="white" stroke-width="3" fill="none" class="track" />
        <polyline id="track-cy2-3-lurus" points="700,300 250,300" stroke="white" stroke-width="3" fill="none" class="track" />
  
        <!-- CY 3A -->
        <polyline id="track-cy3a" points="750,350 250,350" stroke="white" stroke-width="3" fill="none" class="track" />
  
        <!-- CY 3B -->
        <polyline id="track-cy3b" points="750,350 700,400 250,400" stroke="white" stroke-width="3" fill="none" class="track" />
      </svg>
  
      <!-- Input Pairs -->
      <div class="input-pair editor-only" style="top: 190px; left: 280px;">
        <input class="input-box" id="box-cy2-1" placeholder="Ex KA" data-id="cy2-1-ex" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="plan-cy2-1" placeholder="Rencana" data-id="cy2-1-plan" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="sf-cy2-1" placeholder="SF" data-id="cy2-1-sf" />
        <button onclick="clearInputs('cy2-1')">ðŸš‰</button>
      </div>
      <div class="input-pair editor-only" style="top: 240px; left: 280px;">
        <input class="input-box" id="box-cy2-2" placeholder="Ex KA" data-id="cy2-2-ex" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="plan-cy2-2" placeholder="Rencana" data-id="cy2-2-plan" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="sf-cy2-2" placeholder="SF" data-id="cy2-2-sf" />
        <button onclick="clearInputs('cy2-2')">ðŸš‰</button>
      </div>
      <div class="input-pair editor-only" style="top: 290px; left: 280px;">
        <input class="input-box" id="box-cy2-3" placeholder="Ex KA" data-id="cy2-3-ex" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="plan-cy2-3" placeholder="Rencana" data-id="cy2-3-plan" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="sf-cy2-3" placeholder="SF" data-id="cy2-3-sf" />
        <button onclick="clearInputs('cy2-3')">ðŸš‰</button>
      </div>
      <div class="input-pair editor-only" style="top: 340px; left: 280px;">
        <input class="input-box" id="box-cy3a" placeholder="Ex KA" data-id="cy3a-ex" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="plan-cy3a" placeholder="Rencana" data-id="cy3a-plan" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="sf-cy3a" placeholder="SF" data-id="cy3a-sf" />
        <button onclick="clearInputs('cy3a')">ðŸš‰</button>
      </div>
      <div class="input-pair editor-only" style="top: 390px; left: 280px;">
        <input class="input-box" id="box-cy3b" placeholder="Ex KA" data-id="cy3b-ex" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="plan-cy3b" placeholder="Rencana" data-id="cy3b-plan" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="sf-cy3b" placeholder="SF" data-id="cy3b-sf" />
        <button onclick="clearInputs('cy3b')">ðŸš‰</button>
      </div>
  
      <!-- Labels -->
      <div class="label" style="top: 190px;">CY 2 JALUR 1</div>
      <div class="label" style="top: 240px;">CY 2 JALUR 2</div>
      <div class="label" style="top: 290px;">CY 2 JALUR 3</div>
      <div class="label" style="top: 340px;">CY 3A</div>
      <div class="label" style="top: 390px;">CY 3B</div>
  
      <!-- Controls -->
      <div class="controls editor-only">
        <button id="reset">Reset Semua</button>
        <div class="status" id="status">Ketik Ex KA untuk aktifkan jalur. Klik ðŸš‰ jika KA berangkat.</div>
      </div>
    </div>
  </div>

  <div id="wbs" class="tab-content">
    <div class="yard">
      <svg width="1000" height="600">
        <!-- Jalur 1 (perpanjang ke kiri) -->
        <polyline id="jalur-1" points="100,100 800,100" class="track" />
        
        <!-- Jalur 2 (terpisah antara horizontal dan serong) -->
        <polyline id="jalur-2-horizontal" points="100,160 540,160" class="track" />
        <polyline id="jalur-2-diagonal" points="540,160 600,130 650,100" class="track permanent" />
        
        <!-- Jalur 3 (terpisah antara horizontal dan serong) -->
        <polyline id="jalur-3-horizontal" points="100,220 360,220" class="track" />
        <polyline id="jalur-3-diagonal" points="360,220 420,190 480,160" class="track permanent" />
        
        <!-- Jalur 4 (terpisah antara horizontal dan serong) -->
        <polyline id="jalur-4-horizontal" points="100,280 260,280" class="track" />
        <path id="jalur-4-diagonal" d="M260,280 Q300,250 360,220" class="track permanent" />
      </svg>
  
      <!-- Labels -->
      <div class="label" style="top: 90px;">WBS JALUR 1</div>
      <div class="label" style="top: 150px;">WBS JALUR 2</div>
      <div class="label" style="top: 210px;">WBS JALUR 3</div>
      <div class="label" style="top: 270px;">WBS JALUR 4</div>
  
      <!-- Kotak Input (ditempatkan di tengah jalur lurus) -->
      <div class="input-pair editor-only" style="top: 85px; left: 150px;">
        <input class="input-box" id="ex-jalur-1" placeholder="Ex KA" data-id="jalur-1-ex">
        <span class="arrow">âž¡</span>
        <input class="input-box" id="ren-jalur-1" placeholder="Rencana" data-id="jalur-1-ren">
        <span class="arrow">âž¡</span>
        <input class="input-box" id="sf-jalur-1" placeholder="SF" data-id="jalur-1-sf">
        <button onclick="clearInputs('jalur-1')">ðŸš‰</button>
      </div>
      
      <div class="input-pair editor-only" style="top: 145px; left: 150px;">
        <input class="input-box" id="ex-jalur-2" placeholder="Ex KA" data-id="jalur-2-ex">
        <span class="arrow">âž¡</span>
        <input class="input-box" id="ren-jalur-2" placeholder="Rencana" data-id="jalur-2-ren">
        <span class="arrow">âž¡</span>
        <input class="input-box" id="sf-jalur-2" placeholder="SF" data-id="jalur-2-sf">
        <button onclick="clearInputs('jalur-2')">ðŸš‰</button>
      </div>
      
      <div class="input-pair editor-only" style="top: 205px; left: 150px;">
        <input class="input-box" id="ex-jalur-3" placeholder="Ex KA" data-id="jalur-3-ex">
        <span class="arrow">âž¡</span>
        <input class="input-box" id="ren-jalur-3" placeholder="Rencana" data-id="jalur-3-ren">
        <span class="arrow">âž¡</span>
        <input class="input-box" id="sf-jalur-3" placeholder="SF" data-id="jalur-3-sf">
        <button onclick="clearInputs('jalur-3')">ðŸš‰</button>
      </div>
      
      <div class="input-pair editor-only" style="top: 265px; left: 150px;">
        <input class="input-box" id="ex-jalur-4" placeholder="Ex KA" data-id="jalur-4-ex">
        <span class="arrow">âž¡</span>
        <input class="input-box" id="ren-jalur-4" placeholder="Rencana" data-id="jalur-4-ren">
        <span class="arrow">âž¡</span>
        <input class="input-box" id="sf-jalur-4" placeholder="SF" data-id="jalur-4-sf">
        <button onclick="clearInputs('jalur-4')">ðŸš‰</button>
      </div>
    </div>
  </div>

  <div id="fms" class="tab-content">
    <div class="yard">
      <svg width="1000" height="600">
        <!-- Jalur 1 -->
        <polyline id="track-fms-1-serong" points="750,250 700,200" class="track" />
        <polyline id="track-fms-1-lurus" points="700,200 250,200" class="track" />
        
        <!-- Jalur 2 (hanya ke kiri, yang dikontrol oleh kotak input) -->
        <polyline id="track-fms-2" points="750,250 250,250" class="track" />
        <polyline points="750,250 900,250" class="track" style="stroke:white; stroke-width:3;" />
        
        <!-- Jalur 3 -->
        <polyline id="track-fms-3-serong" points="750,250 700,300" class="track" />
        <polyline id="track-fms-3-lurus" points="700,300 250,300" class="track" />
      </svg>

      <!-- Labels -->
      <div class="label" style="top: 190px;">FMS JALUR 1</div>
      <div class="label" style="top: 240px;">FMS JALUR 2</div>
      <div class="label" style="top: 290px;">FMS JALUR 3</div>

      <!-- Input Pairs -->
      <div class="input-pair editor-only" style="top: 190px; left: 280px;">
        <input class="input-box" id="fms-box-1" placeholder="Ex KA" data-id="fms-1-ex" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="fms-plan-1" placeholder="Rencana" data-id="fms-1-plan" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="fms-sf-1" placeholder="SF" data-id="fms-1-sf" />
        <button onclick="clearInputs('fms-1')">ðŸš‰</button>
      </div>
      <div class="input-pair editor-only" style="top: 240px; left: 280px;">
        <input class="input-box" id="fms-box-2" placeholder="Ex KA" data-id="fms-2-ex" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="fms-plan-2" placeholder="Rencana" data-id="fms-2-plan" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="fms-sf-2" placeholder="SF" data-id="fms-2-sf" />
        <button onclick="clearInputs('fms-2')">ðŸš‰</button>
      </div>
      <div class="input-pair editor-only" style="top: 290px; left: 280px;">
        <input class="input-box" id="fms-box-3" placeholder="Ex KA" data-id="fms-3-ex" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="fms-plan-3" placeholder="Rencana" data-id="fms-3-plan" />
        <span class="arrow">âžœ</span>
        <input class="input-box" id="fms-sf-3" placeholder="SF" data-id="fms-3-sf" />
        <button onclick="clearInputs('fms-3')">ðŸš‰</button>
      </div>
    </div>
  </div>

  <script>
    // ===== FIREBASE KONFIGURASI =====
    const firebaseConfig = {
      apiKey: "AIzaSyC6gE0Uqh6PisJWIeiiBrjYYiXKVliw1lg",
      authDomain: "andisagemoy.firebaseapp.com",
      databaseURL: "https://andisagemoy-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "andisagemoy",
      storageBucket: "andisagemoy.firebasestorage.app",
      messagingSenderId: "977705794727",
      appId: "1:977705794727:web:2e0111ad3374ccae3f6f82",
      measurementId: "G-K7C06YSQ11"
    };
    
    // Inisialisasi Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    
    // ===== LOGIN VARIABLES =====
    const CORRECT_USERNAME = "PAP";
    const CORRECT_PASSWORD = "ADMIN";
    let isLoggedIn = false;
    
    // ===== Mapping jalur-jalur untuk update visual =====
    const trackMap = {
      'cy2-1': 'track-cy2-1-lurus',
      'cy2-2': 'track-cy2-2',
      'cy2-3': 'track-cy2-3-lurus',
      'cy3a': 'track-cy3a',
      'cy3b': 'track-cy3b',
      'fms-1': 'track-fms-1-lurus',
      'fms-2': 'track-fms-2',
      'fms-3': 'track-fms-3-lurus'
    };
    
    // ===== DOM ELEMENTS =====
    let loginBtn;
    let loginModal;
    let closeBtn;
    let loginForm;
    let loginError;
    let userStatus;
    let editorOnlyElements;
    
    // ===== SETUP EVENT LISTENERS =====
    document.addEventListener('DOMContentLoaded', function() {
      // Setup login elements
      loginBtn = document.getElementById('loginToggleBtn');
      loginModal = document.getElementById('loginModal');
      closeBtn = document.querySelector('.close-btn');
      loginForm = document.getElementById('loginBtn');
      loginError = document.getElementById('loginError');
      userStatus = document.querySelector('.user-status span');
      
      // Get all editor-only elements
      editorOnlyElements = document.querySelectorAll('.editor-only');
      
      // Initially disable all editor-only elements
      setEditorMode(false);
      
      // Setup login button
      loginBtn.addEventListener('click', function() {
        loginModal.style.display = 'flex';
      });
      
      // Setup close button
      closeBtn.addEventListener('click', function() {
        loginModal.style.display = 'none';
      });
      
      // Setup login form submission
      loginForm.addEventListener('click', function() {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        if (username === CORRECT_USERNAME && password === CORRECT_PASSWORD) {
          // Login successful
          isLoggedIn = true;
          loginModal.style.display = 'none';
          userStatus.textContent = 'Mode: Editor';
          userStatus.className = 'editor-status';
          loginBtn.innerHTML = '<span class="login-icon">ðŸ”’</span> Log Out';
          setEditorMode(true);
        } else {
          // Login failed
          loginError.style.display = 'block';
          setTimeout(() => {
            loginError.style.display = 'none';
          }, 3000);
        }
      });
      
      // Toggle login/logout
      loginBtn.addEventListener('click', function() {
        if (isLoggedIn) {
          // Log out
          isLoggedIn = false;
          userStatus.textContent = 'Mode: Viewer';
          userStatus.className = 'viewer-status';
          loginBtn.innerHTML = '<span class="login-icon">ðŸ‘¤</span> Log In';
          setEditorMode(false);
        } else {
          // Show login modal
          loginModal.style.display = 'flex';
        }
      });
      
      // Close modal when clicking outside
      window.addEventListener('click', function(event) {
        if (event.target === loginModal) {
          loginModal.style.display = 'none';
        }
      });
      
      // Tambahkan event listener untuk semua input box
      document.querySelectorAll('.input-box').forEach(function(input) {
        input.addEventListener('input', function() {
          // Simpan ke Firebase setiap kali nilai diubah
          const dataId = this.getAttribute('data-id');
          database.ref('data/' + dataId).set(this.value);
        });
      });
      
      // Setup tombol reset
      document.getElementById('reset').addEventListener('click', function() {
        // Clear semua input pada tab RMK
        clearInputs('cy2-1');
        clearInputs('cy2-2');
        clearInputs('cy2-3');
        clearInputs('cy3a');
        clearInputs('cy3b');
      });
      
      // Listen untuk updates dari Firebase
      database.ref('data').on('value', function(snapshot) {
        const data = snapshot.val() || {};
        
        // Update semua input box dari data yang diterima
        for (const [key, value] of Object.entries(data)) {
          const input = document.querySelector(`[data-id="${key}"]`);
          if (input && input.value !== value) {
            input.value = value;
          }
          
          // Update visual jalur jika ini adalah input Ex KA
          if (key.endsWith('-ex')) {
            const trackId = key.split('-ex')[0];
            updateTrackVisual(trackId, value);
          }
        }
      });
    });
    
    // ===== HELPER FUNCTIONS =====
    
    // Set editor mode
    function setEditorMode(isEditor) {
      // Toggle editor-only elements
      editorOnlyElements.forEach(element => {
        if (isEditor) {
          element.classList.remove('read-only');
        } else {
          element.classList.add('read-only');
        }
      });
      
      // Toggle input elements
      const inputElements = document.querySelectorAll('.input-box');
      inputElements.forEach(input => {
        input.disabled = !isEditor;
      });
      
      // Toggle buttons
      const buttonElements = document.querySelectorAll('.editor-only button');
      buttonElements.forEach(button => {
        button.disabled = !isEditor;
      });
    }
    
    // Clear inputs
    function clearInputs(trackId) {
      // Check if logged in
      if (!isLoggedIn) return;
      
      // Clear di interface
      const inputs = document.querySelectorAll(`[data-id^="${trackId}-"]`);
      inputs.forEach(input => {
        input.value = '';
      });
      
      // Clear di Firebase
      database.ref('data/' + trackId + '-ex').set('');
      database.ref('data/' + trackId + '-plan').set('');
      database.ref('data/' + trackId + '-sf').set('');
      database.ref('data/' + trackId + '-ren').set('');
    }
    
    // Update visual track
    function updateTrackVisual(trackId, value) {
      // Update untuk RMK dan FMS track
      if (trackMap[trackId]) {
        const trackElement = document.getElementById(trackMap[trackId]);
        if (trackElement) {
          trackElement.style.stroke = value ? 'red' : 'white';
        }
      } 
      // Update untuk WBS track
      else if (trackId.startsWith('jalur-')) {
        const trackElement = document.getElementById(trackId === "jalur-1" ? trackId : `${trackId}-horizontal`);
        if (trackElement) {
          if (value) {
            trackElement.classList.add('occupied');
            trackElement.style.stroke = 'red';
          } else {
            trackElement.classList.remove('occupied');
            trackElement.style.stroke = 'white';
          }
        }
      }
    }
    
    // Switch tab
    function switchTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
      document.querySelectorAll('.tab-button').forEach(el => el.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      
      // Get the button associated with this tab and make it active
      document.querySelectorAll('.tab-button').forEach(btn => {
        if (btn.textContent.toLowerCase().includes(tabId)) {
          btn.classList.add('active');
        }
      });
    }
  </script>
</body>
</html>
