<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Keterlambatan KA</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
        }
        .container {
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 400px;
            width: 100%;
        }
        input, button, select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        button {
            background: #007bff;
            color: white;
            cursor: pointer;
            border: none;
        }
        button:hover {
            background: #0056b3;
        }
        .result {
            font-size: 18px;
            font-weight: bold;
            margin-top: 10px;
        }
        .gapeka-time {
            font-weight: bold;
            color: #ff4500;
        }
        img {
            width: 100px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <img src="train.png" alt="Kereta Api">
    <p id="datetime">‚è≥ Memuat waktu...</p>
    <h2 class="shake">Kalkulator Keterlambatan KA (SIG)</h2>
    <h3 class="shake">Karya anak-anak Simpang</h3>

    <div class="container">
        <input type="text" id="trainNumber" placeholder="Masukkan Nomor KA/L">
        <input type="time" id="realTime">
        <button onclick="calculateDelay()">Hitung Keterlambatan</button>
        <p class="result" id="result"></p>
        <button onclick="goToHome()">Kembali ke Beranda</button>
    </div>

    <script>
        const trainSchedule = {
            "3330": "12:38", "3331": "03:17", "3332": "18:08", "3333": "06:17",
            "3334": "20:38", "3335": "13:48", "3336": "03:07", "3337": "20:03",
            "3440": "07:38", "3441": "05:32", "3442": "15:08", "3443": "12:17",
            "3444": "22:38", "3445": "19:48", "3551": "00:55", "3553": "07:45",
            "3555": "14:30", "3560": "04:08", "3561": "06:47", "3562": "06:53",
            "3563": "16:17", "3564": "10:07", "3565": "17:47", "3566": "11:52",
            "3567": "21:47", "3568": "19:23", "3569": "23:47", "3660": "07:23",
            "3661": "02:17", "3662": "13:38", "3663": "07:17", "3664": "19:38",
            "3665": "13:17", "3666": "02:37", "3667": "18:47", "3770": "03:38",
            "3771": "00:17", "3772": "06:07", "3773": "02:47", "3774": "09:38",
            "3775": "04:17", "3776": "11:07", "3777": "05:16", "3778": "15:39",
            "3779": "10:01", "3780": "16:38", "3781": "11:11", "3782": "20:23",
            "3783": "11:41", "3784": "22:23", "3785": "16:47", "3786": "23:40",
            "3787": "19:17", "3788": "00:55", "3789": "22:47"
        };

        function calculateDelay() {
            const trainNumber = document.getElementById("trainNumber").value;
            const realTime = document.getElementById("realTime").value;
            const resultElement = document.getElementById("result");

            if (!trainSchedule[trainNumber]) {
                resultElement.innerHTML = "Nomor KA tidak ditemukan!";
                return;
            }

            const gapekaTime = trainSchedule[trainNumber];
            const [gapekaHours, gapekaMinutes] = gapekaTime.split(":").map(Number);
            const [realHours, realMinutes] = realTime.split(":").map(Number);

            const gapekaTotalMinutes = (gapekaHours * 60) + gapekaMinutes;
            const realTotalMinutes = (realHours * 60) + realMinutes;

            let delayMinutes = realTotalMinutes - gapekaTotalMinutes;
            let delayMessage = "Tepat waktu";
            let delayCalculation = "(0)";

            if (delayMinutes !== 0) {
                let hours = Math.floor(Math.abs(delayMinutes) / 60);
                let minutes = Math.abs(delayMinutes) % 60;
                let sign = delayMinutes > 0 ? "+" : "-";
                delayMessage = delayMinutes > 0
                    ? `Terlambat ${hours} jam ${minutes} menit`
                    : `Lebih cepat ${hours} jam ${minutes} menit`;
                delayCalculation = `(${sign}${Math.abs(delayMinutes)})`;
            }

            let status = parseInt(trainNumber) % 2 === 0 ? "datang" : "berangkat";

            resultElement.innerHTML = `
                <span class='gapeka-time'>Jadwal GAPEKA: ${gapekaTime} (${status})</span><br>
                ${delayMessage} ${delayCalculation}
            `;
        }

        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById("trainNumber").addEventListener("keypress", function(event) {
                if (event.key === "Enter") {
                    calculateDelay();
                }
            });

            document.getElementById("realTime").addEventListener("keypress", function(event) {
                if (event.key === "Enter") {
                    calculateDelay();
                }
            });
        });

        function goToHome() {
            window.location.href = "index.html";
        }
        function fetchWeather() {
    const apiKey = "ea29a02add724196838122116251203"; // Ganti dengan API Key dari WeatherAPI
    const location = "Simpang, Indonesia"; // Lokasi stasiun
    const url = `https://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${location}&aqi=no`;

    fetch(url)
        .then(response => response.json())
        .then(data => {
            document.getElementById("weather").innerHTML = 
                `üå§Ô∏è Cuaca: ${data.current.condition.text} | üå°Ô∏è Suhu: ${data.current.temp_c}¬∞C`;
        })
        .catch(error => {
            document.getElementById("weather").innerHTML = "‚ö†Ô∏è Gagal memuat cuaca.";
            console.error("Error mengambil data cuaca:", error);
        });
}

// Panggil fungsi saat halaman dimuat
document.addEventListener("DOMContentLoaded", fetchWeather);
function updateDateTime() {
    const now = new Date();
    
    // Format Hari
    const days = ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"];
    const dayName = days[now.getDay()];

    // Format Tanggal
    const date = now.getDate();
    const month = now.toLocaleString("id-ID", { month: "long" }); // Nama bulan dalam bahasa Indonesia
    const year = now.getFullYear();

    // Format Waktu
    const hours = now.getHours().toString().padStart(2, "0");
    const minutes = now.getMinutes().toString().padStart(2, "0");
    const seconds = now.getSeconds().toString().padStart(2, "0");

    // Gabungkan semuanya
    const formattedDateTime = `${dayName}, ${date} ${month} ${year} | ${hours}:${minutes}:${seconds} WIB`;

    // Tampilkan di HTML
    document.getElementById("datetime").innerText = formattedDateTime;
}

// Jalankan update waktu setiap detik
setInterval(updateDateTime, 1000);
document.addEventListener("DOMContentLoaded", updateDateTime);

    </script>
</body>
</html>
